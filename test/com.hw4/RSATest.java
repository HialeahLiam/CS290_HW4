package com.hw4;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import java.io.FileNotFoundException;
import java.math.BigInteger;

public class RSATest {

    @Test
    public void modExp() {
        BigInteger a = new BigInteger("87654321");
        BigInteger b = new BigInteger("98765432");
        BigInteger m = new BigInteger("9876543");

        Assertions.assertEquals(a.modPow(b,m).toString(), RSA.modExp("87654321", "98765432", "9876543"));
    }

    @Test
    public void getDecryptionStrings() throws FileNotFoundException {
        String[] fileArray = {"230539333248",
        "36757473784791647682652538506782785553682759992915484963267902604108769879304288794007213160269135975916751565617778656629736476600442656537831218420563208081390999719746354721909119182835779426492858616241462902604595247245173864171789957346591040758547119710354768434847883434993672913744259254897201057101899594003003587979550723090668906425295610184502161769246398394163908944056962872239306341392544762532476923878659845270624731377616284666426427996788612585033839487762158953502140275462247927970434223771290335995620955093093600699146207627103442078222564056112308094492462961006948865440437681",
        "5251067683541663954664648358111826507668965713273640709038271800586967125614898399143887594324162282273821652231111236661390925228634665219690174060080458297341571388535193531701302740405111346641836945177351843229227892463596266310255708192370148679792445672907824062121126204999096130534894179271026977917825698704694947188677648969595554456320460873531388661530449848721345764370035484982419932507814063815667393712342564957182438171251925308550395852266577187022894183413738020510668395076513890027954512189978108808455788113981627095215181747514444355484237254410168230003786128881320598830817059"};
        String[] methodArray = RSA.getDecryptionStrings("resources/secretMessage.txt", "resources/publicKey.txt", "resources/privateKey.txt");
        Assertions.assertEquals(fileArray[0], methodArray[0]);
        Assertions.assertEquals(fileArray[1], methodArray[1]);
        Assertions.assertEquals(fileArray[2], methodArray[2]);
    }

}





